# [DRAFT] Overview

This document is discovery phase of draft V2 work to be done on Angular.

# Staking

You want to provide assets to be part of borrow amount from market. You stake amount and get fNFT for 3 month. 

You may split/sell fNFT. fNFT has lower price because of value locked, but you assume your earn more by having 

Borrow is used on market. 

# veAngular

As equivalent of staken amount in normalized (stable coing usually) asset you get amount of veANGL 
veANGL shared accross pools. 


# Chiesel model with an integration of Bribe

??


# Gearbox (generalizable knowledge)

https://consensys.net/blog/cryptoeconomic-research/gearbox-protocol-a-composable-leverage-protocol-in-defi/

CreditAccounts(collateral) when vault is deposited, user indicating usage of amounts,
like allowed tokens, liquidaiton ration, activity (margin trading, etc)

Unhealty Positions are liqudate.

Does vault penalizes for fequent withdrawsl of Borrow assets?

Does vault is configured a way to allow its owner to use Collatera(CreditAccounts) according limits?

Penalize withdarawal of assets. 

## TODO:

- read whitepaper and medium article
- outline how it works well with vault pallet
- outline how it works with staking-rewards pallet


# Flash loans

See @KaiserKarel doc on that.


# NFT as collateral

fNFT as collateral. how to determine price? worth return in case of immediate return with penalty? what is penalty?


- ? lender puts amount into `staking-reward`, amount is taken into lending pool,
- ? lender can sell non fungible position


# Persmissioless creation veANGL contolled

So when we create any pool, we need to take ED of veANGL.
veANGL obtained by locking into vault or reward-staking.
? veANGL price is one to one with normalized asset

# Iron bank functionality


# Cross chain

? is it guide on how to create foreign assets to be handled by XCMP/IBC/MOSAIC?

##s Leverage as Service

- No collateral
- Limited whitelisted protocols to be used


### Implementation

### Leverage pallet

- allows you to borrow with collateral equal to some smal amount to cover nearest dept 
- allows to send token to chaos, to pablo
- allows to do some calls on chaos and pablo
- actually this is impersonated proxy


A recent and exciting development in DeFi is the emergence of generalized leverage protocols, which feature a lending pool which allows users to obtain leverage to use with other protocols which have been whitelisted. Gearbox is the most prominent example, but there are others including Sentiment which offer a similar product [1] [2]. While there are various existing protocols offering leverage, especially in the DeFi derivatives space, this concept of generalized leverage, or leverage as a primitive, expands upon the use cases, strategies, and freedom with which margin can be utilized across DeFi. Using Angular Finance as the base layer, we are in a unique position to offer a robust entrant to this exciting new field, which will allow for both the creation of sophisticated strategies which we can offer, allows to maximize exposure to vaults and yield farms of choosing. T

Liquidity Providers deposit assets into a pool, from which users can borrow on margin and take the borrowed asset to protocols of their choice. These initially would include Pablo, CHAOS, and other defi protocols we launch on Picasso, but can be expanded to include others which are deemed suitable for such a service. Any assets purchased on margin must remain in the custody of the protocol until the loan has been repaid, at which point the user keeps the profit minus the accrued fees. 

# Liqudation with ML for better collaterizaion

https://docs.google.com/document/d/1oJSQozCljna1zStVU4N6YpX0RvN0jX1rwyC540fH9HM

? Real time adjustments of factor


## Concentrated Lending

See [Uniswap v3]


- ? do not return fee directly to vault, allow to decide later, so it does not changes utilization ratio. Can send to pallet-staking.
- ? liquidity provided for different Interest Rates

### Areas

- need order book
- need order book integrated with lending
- need lending configurable approciately (ticks if Interest rate)


# Options protocol

Buy rigth to borrow some amount for some amount collateral in future? Is OB needed?


# Hedge engine


# others

just briefly explain

https://docs.euler.finance/getting-started/white-paper

https://medium.com/zklend/introducing-zklend-coming-out-of-stealth-mode-92090d3ce1db


# Defer liquidity check at the end for more complex structuring

???

# Free flash loan

? what means free

# Risk-adjusted liability value with siloting ltv

# Twap oracle factored by weth - to increase cost of arb

? Should we add wETH to XCMP?

# Dutch auction against miners/front-running bots.

We have that and kind of call it from liqudations, where it else to be used?

# Discount booster for MM to avoid liquidation bot profit during the dutch auction.

Is it like prefered liquidatior account? We had that notion once. So it will be able to buy by the price which will be X blocks ahead ? 

# Sell your discount booster for additional yield - this is probably what is going to happen by MM

So it is like membership pallet where places are sold

Stability pool is their internal keeper bot liquidation.

Soft liquidation allows the liquidator to repay the margin call + additional safety factor.

# Insurance fund to avoid run-at-bank and bad debt.

TODO: recheck if that is compatible with vault


# Dynamic interest modeling but with an only internal feedback loop. [should be more dynamics with external yield potential as feedback loops and cross-pool/assets optimization internally.]

# Arb between per the second basis vs per block. - to check. [weakness]

# Transaction builder is cool like defihedge, to optimize gas-fee by sending structured orders.

can provide WASM JS sdk to build common transactions for common set operations, so JS people can build complex TX on their own. 

# Sub-account ok

# missing: optimal cross-pool deployment based on utilization and external yield potential on their dynamic rate modeling.  risk/tricky to have per sec vs per block especially on eth with 'low tps'  there is few improvement here and there who can make sense but not sure it will be enough for attracting tvl to be top1

#  delta-neutral liquidity 

https://twitter.com/guil_lambert/status/1481280620072472580?s=20&t=UNSvmv3QJbmhfp8bNg2nJQ

# Syntetic assets lending



https://hackmd.io/@353yQn6WTImF5o12LQXXfQ/H12oHnWAF


## References

[Whitepaper Uniswap v3](https://uniswap.org/whitepaper-v3.pdf)
[Finematics Uniswap v3](https://www.youtube.com/watch?v=Ehm-OYBmlPM)
[Gearbox](https://medium.com/gearbox-protocol/leverage-2-0-credit-account-as-a-defi-primitive-8be6ea86e883)
[Sentiment](https://medium.com/@sentimentxyz/sentiment-intro-79edf616e7c2)
[Sentiment Twitter](https://twitter.com/sentimentxyz?s=21it)